<%# section: 'pageStylesheets' %>
<%= stylesheet_link_tag "css/style" %>
<style>
    #content img {
        width: 100% !important;
    }
    #data-table-users td {
        text-align: center;
        vertical-align: middle;
    }
    [data-target *= "hidden-by-default"]:focus {
        outline: none;
    }
    .error {
        color: red;
        display: block;
        padding: 0;
        margin: 0;
    }
    .list-upload:hover {
        color: #1976d2;
        background: #e7f6fe;
    }
    #add-file-button:hover {
        color: #00897b;
        cursor: pointer;
    }
    .el-element-overlay .el-card-item {
      padding-bottom: 0;
    }
    .el-element-overlay .el-card-item .el-card-avatar {
      margin-bottom: 0;
    }
    .el-element-overlay .el-card-item .el-overlay-1:hover img {
      -ms-transform: scale(1) translateZ(0);
      -webkit-transform: scale(1) translateZ(0);
    }
</style>


<%# section: 'contents' %>

<div class="row page-titles">
  <div class="col-md-5 align-self-center">
    <h3 class="text-themecolor">Artwork View</h3>
  </div>
  <div class="col-md-7 align-self-center">
    <ol class="breadcrumb">
      <li class="breadcrumb-item"><a href="/">Home</a></li>
      <li class="breadcrumb-item">Artwork</li>
      <li class="breadcrumb-item active">Show</li>
    </ol>
  </div>
</div>

<div class="container-fluid">
    <div class="row el-element-overlay">
        <!-- Column -->
        <div class="col-lg-8 col-xlg-8 col-md-12 col-sm-12" id="left-info-container">
            <div class="card" id="left-info">
<%
=begin%>
 <%# if (@artwork.status == 'published') %>
                  <%# if (session().get('admin')['role_id'] == 1) %>
                  <div class="ribbon ribbon-info ribbon-right">Active</div>
                  <%# endif %>
                  <%# if (@artwork.max_quantity <= @artwork.learner_count) %>
                  <div class="ribbon ribbon-danger">Full</div>
                  <%# else %>
                  <div class="ribbon ribbon-info">Available</div>
                  <%# endif %>
              <%# elseif (@artwork.status == 'inactive')  %>
              <div class="ribbon ribbon-danger ribbon-right">Inactive</div>
              <%# elseif (@artwork.status == 'draft')  %>
              <div class="ribbon ribbon-default ribbon-right">Draft</div>
              <%# endif %> 
<%
=end%>
              <div class="el-card-item">
                <div class="el-card-avatar el-overlay-1">
                    <%= image_tag  @artwork.img_link, class: 'card-img-top img-responsive' %>
                </div>
                <div class="el-card-content">
                  <div class="row m-t-10">
                    <div class="col-3 b-r">
                      <div class="text-center">
                        <h5>
                          <i class="ti-heart btn" data-toggle="tooltip" data-placement="bottom" title="Heart">
                          </i>
                          <%#= @artwork.favorites.count %> 999
                        </h5>
                      </div>
                    </div>
                    <div class="col-3 b-r">
                      <div class="text-center">
                        <h5>
                          <i class="ti-download btn" data-toggle="tooltip" data-placement="bottom" title="Download"></i>
                          <%#= @artwork.downloadcount %>
                        </h5>
                      </div>
                    </div>
                    <div class="col-3 b-r">
                      <div class="text-center">
                        <h5>
                          <i class="ti-share btn" data-toggle="tooltip" data-placement="bottom" title="Share"></i>
                          <%#= @artwork.sharecount %>
                        </h5>
                      </div>
                    </div>
                    <div class="col-3">
                      <div class="text-center">
                        <h5>
                          <i class="ti-flag-alt-2 btn" data-toggle="tooltip" data-placement="bottom" title="Report"></i>
                        </h5>
                      </div>
                    </div>
                  </div>
                  <div class="row m-l-10 m-t-10">
                    <div class="col-12">
                      <div class="text-left vm">
                        <h3 class="text-themecolor m-t-10">
                          <%= @artwork.name %>
                        </h3>
                        <br/>
                      </div>
                    </div>
                    <div class="col-12">
                      <div class="text-left">
                        <h5>
                          <i class="icon-user"></i>
                          <%#= @artwork.user.avatar, link %>
                          <%#= @artwork.user.name, link %>
                          Daniel
                        </h5>
                      </div>
                    </div>
                    <div class="col-12">
                      <div class="text-left">
                        <h5>
                          <small>
                            <i class="icon-clock date"></i> on
                            <%= @artwork.created_at.strftime("%H:%M - %b %d, %Y") %>
                          </small>
                        </h5>
                      </div>
                    </div>
                    <div class="col-12 m-t-10">
                      <div class="text-left">
                        <h4>Description</h4>
                        <hr />
                        <p>
                          <%#= @artwork.description %>
                          Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam, eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt explicabo. Nemo enim ipsam voluptatem quia voluptas sit aspernatur aut odit aut fugit, sed quia consequuntur magni dolores eos qui ratione voluptatem sequi nesciunt. Neque porro quisquam est, qui dolorem ipsum quia dolor sit amet, consectetur, adipisci velit, sed quia non numquam eius modi tempora incidunt ut labore et dolore magnam aliquam quaerat voluptatem. Ut enim ad minima veniam, quis nostrum exercitationem ullam corporis suscipit laboriosam, nisi ut aliquid ex ea commodi consequatur? Quis autem vel eum iure reprehenderit qui in ea voluptate velit esse quam nihil molestiae consequatur, vel illum qui dolorem eum fugiat quo voluptas nulla pariatur?
                        </p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
<%
=begin%>
 <div class="card-body" id="left-info-footer">
                  <div class="text-left">
                  <% @artwork.tags.each do |tag| %>
                    <%= link_to tag.name,
                                link_to_artworks_with_same_tag
                                class: "btn btn-sm btn-outline-info"
                                style: "margin-bottom: 5px;" %>
                  <% end %>
                  </div>
              </div> 
<%
=end%>
            </div>
        </div>
        <!-- Column -->

        <!-- Column -->
        <div class="col-lg-4 col-xlg-4 col-md-12 col-sm-12" id="right-info-container">   
            <div class="card">
                <!-- Nav tabs // change to simple scrollable list -->
                <ul class="nav nav-tabs profile-tab" role="tablist">
                    <li class="nav-item">
                      <a class="nav-link active" data-toggle="tab" href="#simarts" role="tab">Similar Artworks</a>
                    </li>
                    <li class="nav-item">
                      <a class="nav-link" data-toggle="tab" href="#sameauthor" role="tab" id="tab_sameau">From same author</a>
                    </li>
                </ul>
                <!-- Tab panes -->
                <div class="tab-content" id="right-info">
                    <div class="tab-pane active" id="simarts" role="tabpanel">
                      <% @similar.each do |simart| %>
                      <div class="el-card-item">
                        <div class="el-card-avatar el-overlay-1">
                          <%= link_to  artwork_path(simart),
                              class: 'image-popup-vertical-fit' do %>
                            <%= image_tag  simart.img_link,
                                           alt: 'Oops!' %>
                          <% end %>
                        </div>
                      </div>
                      <% end %>
                    </div>
                    <div class="tab-pane" id="sameauthor" role="tabpanel">
                      <% @same_author.each do |sameauthor| %>
                      <div class="el-card-item">
                        <div class="el-card-avatar el-overlay-1">
                          <%= link_to  artwork_path(sameauthor),
                              class: 'image-popup-vertical-fit' do %>
                            <%= image_tag  sameauthor.img_link,
                                           alt: 'Oops!' %>
                          <% end %>
                        </div>
                      </div>
                      <% end %>
                    </div>
                </div>
            </div>
        <!-- Column -->
        </div>
    </div>
</div>


<%# section: 'pageScripts' %>
<%#= javascript_pack_tag 'jquery.lockfixed' %>
<%#= javascript_pack_tag 'form_validation' %>

<script>
    let date = new Date();
    $(document).ready(function () {
        $('.card-body#left-info-body').each(function() {
            left_body_height += $(this).outerHeight();
        });

        let right_info = $("div.card-body#content").height();
        $('a[data-toggle="tab"]').on('shown.bs.tab', function (e) {
            var target = $(e.target).attr("href") // activated tab
            if (target == "#home") {
                right_info = $(".card-body#content").height();
            } else if (target == "#settings") {
                right_info = $(".card-body#instructors").height();
            } else if (target == "#learnersdiv") {
                right_info = $(".card-body#learners").height();
            } 
        });
        
        let left_info = $('#left-info').height();
        let left_info_title = $("#left-info-title.card-body").height();
        let img = $(".card-img-top").height();
        let right_info_container = $("#right-info-container").height();
        let footer = $('.footer').height();
        let width = $(window).width();
        let height = $(window).height();
        if (width >= 1024 && height >= 600) {
            if (left_info < right_info) {   
                let left_info_container = $("#left-info-container").height();
                let left_info_to_footer = $('#left-info-container').height() - $('#left-info').height();
                if (left_body_height < height) {
                    $.lockfixed("#left-info", {offset: {top: 60, bottom: footer + (right_info_container - right_info - 10)} });
                } else {
                    $.lockfixed("#left-info", {offset: {top: -(left_info - height), bottom: footer + (right_info_container - right_info)}});
                }
            }
        }
    });
</script>
